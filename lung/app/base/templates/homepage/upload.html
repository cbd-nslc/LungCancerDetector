{% extends "base.html" %}

{% block title %} {{ title }} {% endblock title %}

{% block stylesheets %}
  {{ super() }}
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
{% endblock stylesheets %}


{% block main %}
    <main id="main">
      <div class="hero-section inner-page">
        <div class="wave">

          <svg width="1920px" height="265px" viewBox="0 0 1920 265" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="Apple-TV" transform="translate(0.000000, -402.000000)" fill="#FFFFFF">
                      <path d="M0,439.134243 C175.04074,464.89273 327.944386,477.771974 458.710937,477.771974 C654.860765,477.771974 870.645295,442.632362 1205.9828,410.192501 C1429.54114,388.565926 1667.54687,411.092417 1920,477.771974 L1920,667 L1017.15166,667 L0,667 L0,439.134243 Z" id="Path"></path>
                  </g>
              </g>
          </svg>

        </div>

        <div class="container">
          <div class="row align-items-center">
            <div class="col-12">
              <div class="row justify-content-center">
                <div class="col-md-7 text-center hero-text">
                  <h1 data-aos="fade-up" data-aos-delay="">Step 1</h1>
                  <p class="mb-5" data-aos="fade-up"  data-aos-delay="100">Upload your CT Scan</p>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="site-section">
        <div class="container">
          <div class="row mb-5 align-items-end">
            <!-- -->
            <div class="col-md-6" data-aos="fade-up">
              <h2>Upload Form</h2>
              <p class="mb-0">Upload</p>
            </div>

          </div>


            <form class="row mb-12 align-items-end" method="POST" enctype="multipart/form-data">
              {{ form.hidden_tag() }}
              <!-- center box -->
              <div class="center box">
                <div class="title">
                    <h1>Drop file to upload</h1>
                </div>

                <div class="row-md-12">
                  {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }} text-center" style="font-size:16px">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}
                  {% endwith %}

                  {% if form.ct_scan.errors %}
                    {% for error in form.ct_scan.errors %}
                        <span class='text-danger'>{{ error }}</span><br>
                    {% endfor %}
                  {% endif %}
                </div>

                <!-- dropzone -->
                <div class="dropzone">
                  {{ form.ct_scan(class="upload-input") }}
                  <span><p class="file-name">Browse</p></span>
                </div>
                <!-- end dropzone -->

              </div>
              <!-- center box -->

              <div class="col-md-12 text-center">
                {{ form.submit(class='btn btn-primary', onclick="$('#loader').show(); myFunction()") }}

                {{ form.cancel(class="btn btn-secondary", formnovalidate=True) }}

                <input class="btn btn-primary" onclick="$('#loader').show(); myFunction()" value="Cancel">
              </div>
            </form>

        </div>
      </div>
      <p>{{ loading }}</p>

        <div id="loader">
          <p>Your file is being processed. This might take a few minutes!</p>
        </div>

        <script>
          var myVar;

          function myFunction() {
            myVar = setTimeout(showPage, 3000);
          }
          function showPage() {
            document.getElementById("loader").style.display = "none";
            window.location.href = "{{ url_for('base_blueprint.result', ct_scan_name=form.ct_scan.data.filename) }}";
          }
        </script>






      <div class="site-section cta-section">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-6 mr-auto text-center text-md-left mb-5 mb-md-0">
              <h2>Starts Publishing Your Apps</h2>
            </div>
            <div class="col-md-5 text-center text-md-right">
              <p><a href="#" class="btn"><span class="icofont-brand-apple mr-3"></span>App store</a> <a href="#" class="btn"><span class="icofont-ui-play mr-3"></span>Google play</a></p>
            </div>
          </div>
        </div>
      </div>


    </main>
{% endblock main %}